<?php
echo $this->doctype();

$user = $this->userHelper();

$manifestPath = __DIR__ . '/../../../../public/build/.vite/manifest.json'; // adjust path
if (!$manifestPath || !file_exists($manifestPath)) {
    throw new \RuntimeException('Vite manifest file not found: ' . $manifestPath);
}
$manifest = json_decode(file_get_contents($manifestPath), true);

function vite_asset(string $entry, array $manifest): string
{
    if (!isset($manifest[$entry])) {
        return '';
    }

    $html = '';
    $entryInfo = $manifest[$entry];

    // Load CSS
    if (!empty($entryInfo['css'])) {
        foreach ($entryInfo['css'] as $css) {
            $html .= '<link rel="stylesheet" href="/build/' . $css . '">' . PHP_EOL;
        }
    }

    // Load main JS
    $html .= '<script type="module" src="/build/' . $entryInfo['file'] . '"></script>' . PHP_EOL;

    return $html;
}
?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="light">

<head>

    <?php echo $this->headTitle('P2Q')->setSeparator(' - ')->setAutoEscape(false); ?>
    <?php echo $this->headMeta()
        ->appendName('viewport', 'width=device-width, initial-scale=1.0')
        //->appendHttpEquiv('X-UA-Compatible', 'IE=edge')
        ->appendName('description', 'Project to Quote'); ?>
    <meta charset="utf-8">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico.png">
    <link href="/css/index.css" rel="stylesheet" type="text/css">
    <link href="/build/main.css" rel="stylesheet">
    <?php
    //echo $this->headLink();
    ?>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <!-- jMigrate CDN -->
    <script src="https://code.jquery.com/jquery-migrate-3.4.1.js"></script>

    <!-- jQuery UI CDN -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js" integrity="sha256-lSjKY0/srUM9BE3dPm+c4fBo1dky2v27Gdjm2uoZaL0=" crossorigin="anonymous"></script>
    <script>
        (function() {
            const theme = localStorage.getItem("theme");
            if (theme === "dark" || theme === "light") {
                document.documentElement.className = theme;
            }
        })();
    </script>
</head>

<body>
    <div id="root">
        <div class="page-wrapper category-html document-page">
            <div class="sticky-header-container">
                <header class="top-navigation bg-background">
                    <div class="container-a bg-widget-background mr-auto ml-auto flex w-full flex-col justify-between gap-4 pt-2 pr-4 pb-2 pl-4 lg:flex-row">
                        <div class="top-navigation-wrap flex h-8 flex-auto items-center justify-between lg:flex-0">
                            <a href="/" class="logo logo w-40" aria-label="Centura Quotation homepage">
                                <svg id="centura-logo" width="200" height="20" viewBox="0 0 200 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" role="img">
                                    <title>Centura Quotation Portal</title>
                                    <path d="M113.755 0.361084H87.4381V5.40201H97.9096V19.524H103.284V5.40201H113.755V0.361084Z" />
                                    <path d="M184.922 18.8939C184.843 18.8939 184.803 18.8939 184.724 18.8939C184.685 18.8939 184.764 17.4483 184.764 17.3742C184.764 16.8182 183.183 17.5225 182.867 17.4113C182.946 17.2259 183.223 16.8553 183.104 16.67C182.512 16.1881 181.919 15.7804 181.326 15.2985V15.2615C181.919 15.0391 181.524 14.4831 181.405 13.9271C182.235 14.0754 182.353 14.2978 182.749 13.5194C182.828 13.5194 183.736 14.8537 183.855 14.3348C183.697 13.7418 183.578 13.1117 183.42 12.4815C183.618 12.5557 183.816 12.741 184.092 12.7781C184.132 12.7781 184.132 12.7781 184.171 12.7781C184.487 12.4445 184.645 11.9997 184.882 11.629C185.08 11.9997 185.278 12.4445 185.594 12.7781C185.633 12.7781 185.673 12.7781 185.673 12.7781C185.989 12.741 186.147 12.5557 186.344 12.4815C186.186 13.1117 186.068 13.7047 185.91 14.3348C186.028 14.8537 186.937 13.5194 187.016 13.5194C187.411 14.2978 187.49 14.0383 188.36 13.9271C188.241 14.4831 187.846 15.0391 188.439 15.2615V15.2985C187.846 15.7433 187.253 16.151 186.661 16.67C186.542 16.8553 186.779 17.1889 186.898 17.4113C186.621 17.4854 185.001 16.7812 185.001 17.3742C185.001 17.4483 185.08 18.8939 185.04 18.8939C185.04 18.8939 184.961 18.8939 184.922 18.8939Z" fill="#AAACB0" />
                                    <path d="M199.582 19.524L187.965 0.361084H181.84L170.222 19.524H176.387L184.883 5.51321L193.378 19.524H199.582Z" />
                                    <path d="M82.0643 0.361084C80.6022 0.361084 79.3772 1.47305 79.3772 2.88155V14.5202L66.4953 0.361084H58.4342V19.524H63.8083V5.40201L76.6902 19.524H84.7513V0.361084H82.0643Z" />
                                    <path d="M142.759 0.361084H137.385V13.2599C137.385 13.9642 136.793 14.5202 136.042 14.5202H123.16C122.409 14.5202 121.816 13.9642 121.816 13.2599V2.88155C121.816 1.51012 120.631 0.361084 119.129 0.361084H116.442V17.0406C116.442 18.375 117.549 19.4499 118.932 19.524V19.5611H140.072C141.534 19.5611 142.759 18.4491 142.759 17.0406V0.361084Z" />
                                    <path d="M53.0601 5.40201C54.5617 5.40201 55.7471 4.29004 55.7471 2.88155V0.361084H32.1171C30.655 0.361084 29.4301 1.47305 29.4301 2.88155V17.0406C29.4301 18.4491 30.6155 19.5611 32.1171 19.5611H55.7471V14.5202H34.8041V11.9997H47.686C49.1481 11.9997 50.3731 10.8877 50.3731 9.47923V7.92247H34.8041V5.43908H53.0601V5.40201Z" />
                                    <path d="M7.14347 5.40201H24.0559C25.5575 5.40201 26.743 4.29004 26.743 2.88155V0.361084H3.11293C1.61136 0.361084 0.425903 1.47305 0.425903 2.88155V17.0406C0.425903 18.4491 1.61136 19.5611 3.11293 19.5611H26.743V14.5202H7.14347C6.39268 14.5202 5.79996 13.9642 5.79996 13.2599V6.66224C5.79996 5.958 6.39268 5.40201 7.14347 5.40201Z" />
                                    <path d="M171.724 9.96108V5.40201C171.724 2.62209 169.353 0.361084 166.389 0.361084H145.446V19.524H150.82V5.40201H165.046C165.797 5.40201 166.389 5.958 166.389 6.66224V9.18271C166.389 9.88695 165.797 10.4429 165.046 10.4429H153.31V11.9997C153.31 13.3711 154.495 14.5202 155.997 14.5202H166.389V19.5611H171.763V15.002C171.763 13.5935 170.578 12.4815 169.076 12.4815C170.538 12.4445 171.724 11.3325 171.724 9.96108Z" />
                                </svg>
                            </a>

                            <button title="Open main menu" type="button" class="button action has-icon main-menu-toggle lg:hidden" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false">
                                <span class="button-wrap">
                                    <span class="icon icon-menu"></span>
                                    <span class="visually-hidden">Open main menu</span>
                                </span>
                            </button>
                        </div>

                        <div class="top-navigation-main hidden flex-col items-center lg:flex lg:flex-row">
                            <nav class="main-nav" id="leftSide"></nav>
                            <div class="theme-switcher-menu">
                                <button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu">
                                    <span class="button-wrap">
                                        <span class="icon icon-theme-light"></span>
                                        <span class="text-[11px]">Theme</span>
                                    </span>
                                </button>
                            </div>

                            <div class="top-level-entry-container user-menu">
                                <button id="centura-account-button" title="User account" aria-expanded="false" type="button" class="button action top-level-entry menu-toggle user-menu-toggle" aria-controls="centura-account" aria-haspopup="menu">
                                    <span class="button-wrap">
                                        <div class="avatar-wrap" aria-hidden="true">
                                            <svg width="30" height="30" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M12 12.25C11.2583 12.25 10.5333 12.0301 9.91661 11.618C9.29993 11.206 8.81928 10.6203 8.53545 9.93506C8.25163 9.24984 8.17736 8.49584 8.32206 7.76841C8.46675 7.04098 8.8239 6.3728 9.34835 5.84835C9.8728 5.3239 10.541 4.96675 11.2684 4.82206C11.9958 4.67736 12.7498 4.75162 13.4351 5.03545C14.1203 5.31928 14.706 5.79993 15.118 6.41661C15.5301 7.0333 15.75 7.75832 15.75 8.5C15.75 9.49456 15.3549 10.4484 14.6517 11.1517C13.9484 11.8549 12.9946 12.25 12 12.25ZM12 6.25C11.555 6.25 11.12 6.38196 10.75 6.62919C10.38 6.87643 10.0916 7.22783 9.92127 7.63896C9.75098 8.0501 9.70642 8.5025 9.79323 8.93895C9.88005 9.37541 10.0943 9.77632 10.409 10.091C10.7237 10.4057 11.1246 10.62 11.561 10.7068C11.9975 10.7936 12.4499 10.749 12.861 10.5787C13.2722 10.4084 13.6236 10.12 13.8708 9.75003C14.118 9.38002 14.25 8.94501 14.25 8.5C14.25 7.90326 14.0129 7.33097 13.591 6.90901C13.169 6.48705 12.5967 6.25 12 6.25Z" />
                                                <path d="M19 19.25C18.8019 19.2474 18.6126 19.1676 18.4725 19.0275C18.3324 18.8874 18.2526 18.6981 18.25 18.5C18.25 16.55 17.19 15.25 12 15.25C6.81 15.25 5.75 16.55 5.75 18.5C5.75 18.6989 5.67098 18.8897 5.53033 19.0303C5.38968 19.171 5.19891 19.25 5 19.25C4.80109 19.25 4.61032 19.171 4.46967 19.0303C4.32902 18.8897 4.25 18.6989 4.25 18.5C4.25 13.75 9.68 13.75 12 13.75C14.32 13.75 19.75 13.75 19.75 18.5C19.7474 18.6981 19.6676 18.8874 19.5275 19.0275C19.3874 19.1676 19.1981 19.2474 19 19.25Z" />
                                            </svg>
                                        </div>
                                    </span>
                                </button>

                                <ul id="centura-account" style="display: none;" class="submenu centura-account inline-submenu-lg" aria-labelledby="centura-account-button">
                                    <li class="submenu-header">
                                        <div class="submenu-item">
                                            <div class="submenu-content-container">
                                                <div class="submenu-item-heading">
                                                    Signed in as <?php echo $this->escapeHtml($user['id']) ?? ''; ?>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <li class="signout-container">
                                        <form class="signout-form" method="post" action="/logout">
                                            <button type="submit" class="button secondary signout-button">
                                                <span class="button-wrap">
                                                    Sign Out
                                                </span>
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </header>
            </div>
            <div class="main-wrapper" id="main-wrapper">
                <?php echo $this->layout()->content; ?>
            </div>
        </div>
    </div>

    <?= vite_asset('p2q.ts', $manifest) ?>
    <?= vite_asset('app.ts', $manifest) ?>
</body>

<!-- Footer -->
<footer class="footer">
    <?php echo $this->render('footer.phtml'); ?>
</footer>

</html>
